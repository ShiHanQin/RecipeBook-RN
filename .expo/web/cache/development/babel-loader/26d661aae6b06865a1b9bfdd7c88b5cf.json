{"ast":null,"code":"import _extends from \"@babel/runtime/helpers/extends\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _inherits from \"@babel/runtime/helpers/inherits\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/getPrototypeOf\";\nvar _jsxFileName = \"C:\\\\Users\\\\shiha\\\\Desktop\\\\repo\\\\RecipeBook-RN\\\\node_modules\\\\react-native-instagram-login\\\\Instagram.js\";\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nimport React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport View from \"react-native-web/dist/exports/View\";\nimport Alert from \"react-native-web/dist/exports/Alert\";\nimport Modal from \"react-native-web/dist/exports/Modal\";\nimport Dimensions from \"react-native-web/dist/exports/Dimensions\";\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport Image from \"react-native-web/dist/exports/Image\";\nimport qs from 'qs';\nimport axios from 'axios';\nimport { WebView } from 'react-native-webview';\n\nvar _Dimensions$get = Dimensions.get('window'),\n    width = _Dimensions$get.width,\n    height = _Dimensions$get.height;\n\nvar patchPostMessageJsCode = \"(\" + String(function () {\n  var originalPostMessage = window.postMessage;\n\n  var patchedPostMessage = function patchedPostMessage(message, targetOrigin, transfer) {\n    originalPostMessage(message, targetOrigin, transfer);\n  };\n\n  patchedPostMessage.toString = function () {\n    return String(Object.hasOwnProperty).replace('hasOwnProperty', 'postMessage');\n  };\n\n  window.postMessage = patchedPostMessage;\n}) + \")();\";\n\nvar Instagram = function (_Component) {\n  _inherits(Instagram, _Component);\n\n  var _super = _createSuper(Instagram);\n\n  function Instagram(props) {\n    var _this;\n\n    _classCallCheck(this, Instagram);\n\n    _this = _super.call(this, props);\n    _this.state = {\n      modalVisible: false,\n      key: 1\n    };\n    return _this;\n  }\n\n  _createClass(Instagram, [{\n    key: \"show\",\n    value: function show() {\n      this.setState({\n        modalVisible: true\n      });\n    }\n  }, {\n    key: \"hide\",\n    value: function hide() {\n      this.setState({\n        modalVisible: false\n      });\n    }\n  }, {\n    key: \"onNavigationStateChange\",\n    value: function onNavigationStateChange(webViewState) {\n      var url, key, match, results, code, _this$props, appId, appSecret, redirectUrl, responseType, headers, http, form, res;\n\n      return _regeneratorRuntime.async(function onNavigationStateChange$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              url = webViewState.url;\n              key = this.state.key;\n\n              if (webViewState.title === 'Instagram' && webViewState.url === 'https://www.instagram.com/') {\n                this.setState({\n                  key: key + 1\n                });\n              }\n\n              if (!(url && url.startsWith(this.props.redirectUrl))) {\n                _context.next = 35;\n                break;\n              }\n\n              this.webView.stopLoading();\n              match = url.match(/(#|\\?)(.*)/);\n              results = qs.parse(match[2]);\n              this.hide();\n\n              if (!results.access_token) {\n                _context.next = 12;\n                break;\n              }\n\n              this.props.onLoginSuccess(results.access_token, results);\n              _context.next = 35;\n              break;\n\n            case 12:\n              if (!results.code) {\n                _context.next = 34;\n                break;\n              }\n\n              code = results.code;\n              code = code.split('#_').join('');\n              _this$props = this.props, appId = _this$props.appId, appSecret = _this$props.appSecret, redirectUrl = _this$props.redirectUrl, responseType = _this$props.responseType;\n\n              if (!(responseType === 'code' && !appSecret)) {\n                _context.next = 20;\n                break;\n              }\n\n              if (code) {\n                this.props.onLoginSuccess(code, results);\n              } else {\n                this.props.onLoginFailure(results);\n              }\n\n              _context.next = 32;\n              break;\n\n            case 20:\n              headers = {\n                'Content-Type': 'application/x-www-form-urlencoded'\n              };\n              http = axios.create({\n                baseURL: 'https://api.instagram.com/oauth/access_token',\n                headers: headers\n              });\n              form = new FormData();\n              form.append('app_id', appId);\n              form.append('app_secret', appSecret);\n              form.append('grant_type', 'authorization_code');\n              form.append('redirect_uri', redirectUrl);\n              form.append('code', code);\n              _context.next = 30;\n              return _regeneratorRuntime.awrap(http.post('/', form).catch(function (error) {\n                console.log(error.response);\n                return false;\n              }));\n\n            case 30:\n              res = _context.sent;\n\n              if (res) {\n                this.props.onLoginSuccess(res.data, results);\n              } else {\n                this.props.onLoginFailure(results);\n              }\n\n            case 32:\n              _context.next = 35;\n              break;\n\n            case 34:\n              this.props.onLoginFailure(results);\n\n            case 35:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, null, this, null, Promise);\n    }\n  }, {\n    key: \"onMessage\",\n    value: function onMessage(reactMessage) {\n      try {\n        var json = JSON.parse(reactMessage.nativeEvent.data);\n\n        if (json && json.error_type) {\n          this.hide();\n          this.props.onLoginFailure(json);\n        }\n      } catch (err) {}\n    }\n  }, {\n    key: \"renderClose\",\n    value: function renderClose() {\n      var renderClose = this.props.renderClose;\n\n      if (renderClose) {\n        return renderClose();\n      }\n\n      return React.createElement(Image, {\n        source: require(\"./assets/close-button.png\"),\n        style: styles.imgClose,\n        resizeMode: \"contain\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 120,\n          columnNumber: 7\n        }\n      });\n    }\n  }, {\n    key: \"onClose\",\n    value: function onClose() {\n      var onClose = this.props.onClose;\n\n      if (onClose) {\n        onClose();\n      }\n\n      this.hide();\n    }\n  }, {\n    key: \"renderWebview\",\n    value: function renderWebview() {\n      var _this2 = this;\n\n      var _this$props2 = this.props,\n          appId = _this$props2.appId,\n          appSecret = _this$props2.appSecret,\n          redirectUrl = _this$props2.redirectUrl,\n          scopes = _this$props2.scopes,\n          responseType = _this$props2.responseType;\n      var key = this.state.key;\n      var ig_uri = \"https://api.instagram.com/oauth/authorize/?app_id=\" + appId + \"&redirect_uri=\" + redirectUrl + \"&response_type=\" + responseType + \"&scope=\" + scopes.join(',');\n      return React.createElement(WebView, _extends({}, this.props, {\n        key: key,\n        style: [styles.webView, this.props.styles.webView],\n        source: {\n          uri: ig_uri\n        },\n        startInLoadingState: true,\n        onNavigationStateChange: this.onNavigationStateChange.bind(this),\n        onError: this.onNavigationStateChange.bind(this),\n        onMessage: this.onMessage.bind(this),\n        ref: function ref(webView) {\n          _this2.webView = webView;\n        },\n        injectedJavaScript: patchPostMessageJsCode,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 144,\n          columnNumber: 7\n        }\n      }));\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this3 = this;\n\n      var _this$props3 = this.props,\n          wrapperStyle = _this$props3.wrapperStyle,\n          containerStyle = _this$props3.containerStyle,\n          closeStyle = _this$props3.closeStyle;\n      return React.createElement(Modal, {\n        animationType: 'slide',\n        visible: this.state.modalVisible,\n        onRequestClose: this.onClose.bind(this),\n        transparent: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 165,\n          columnNumber: 7\n        }\n      }, React.createElement(View, {\n        style: [styles.container, containerStyle],\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 170,\n          columnNumber: 9\n        }\n      }, React.createElement(View, {\n        style: [styles.wrapper, wrapperStyle],\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 171,\n          columnNumber: 11\n        }\n      }, this.renderWebview()), React.createElement(TouchableOpacity, {\n        onPress: function onPress() {\n          return _this3.onClose();\n        },\n        style: [styles.close, closeStyle],\n        accessibilityComponentType: 'button',\n        accessibilityTraits: ['button'],\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 174,\n          columnNumber: 11\n        }\n      }, this.renderClose())));\n    }\n  }]);\n\n  return Instagram;\n}(Component);\n\nexport { Instagram as default };\nvar propTypes = {\n  appId: PropTypes.string.isRequired,\n  appSecret: PropTypes.string.isRequired,\n  redirectUrl: PropTypes.string,\n  scopes: PropTypes.array,\n  onLoginSuccess: PropTypes.func,\n  modalVisible: PropTypes.bool,\n  onLoginFailure: PropTypes.func,\n  responseType: PropTypes.string,\n  containerStyle: PropTypes.object,\n  wrapperStyle: PropTypes.object,\n  closeStyle: PropTypes.object\n};\nvar defaultProps = {\n  redirectUrl: 'https://google.com',\n  styles: {},\n  scopes: ['user_profile', 'user_media'],\n  onLoginSuccess: function onLoginSuccess(token) {\n    Alert.alert('Alert Title', 'Token: ' + token, [{\n      text: 'OK'\n    }], {\n      cancelable: false\n    });\n  },\n  onLoginFailure: function onLoginFailure(failureJson) {\n    console.debug(failureJson);\n  },\n  responseType: 'code'\n};\nInstagram.propTypes = propTypes;\nInstagram.defaultProps = defaultProps;\nvar styles = StyleSheet.create({\n  webView: {\n    flex: 1\n  },\n  container: {\n    flex: 1,\n    backgroundColor: 'rgba(0, 0, 0, 0.5)',\n    paddingVertical: 40,\n    paddingHorizontal: 10\n  },\n  wrapper: {\n    flex: 1,\n    borderRadius: 5,\n    borderWidth: 5,\n    borderColor: 'rgba(0, 0, 0, 0.6)'\n  },\n  close: {\n    position: 'absolute',\n    top: 35,\n    right: 5,\n    backgroundColor: '#000',\n    borderWidth: 2,\n    borderColor: 'rgba(0, 0, 0, 0.4)',\n    width: 30,\n    height: 30,\n    justifyContent: 'center',\n    alignItems: 'center',\n    borderRadius: 15\n  },\n  imgClose: {\n    width: 30,\n    height: 30\n  }\n});","map":{"version":3,"sources":["C:/Users/shiha/Desktop/repo/RecipeBook-RN/node_modules/react-native-instagram-login/Instagram.js"],"names":["React","Component","PropTypes","qs","axios","WebView","Dimensions","get","width","height","patchPostMessageJsCode","String","originalPostMessage","window","postMessage","patchedPostMessage","message","targetOrigin","transfer","toString","Object","hasOwnProperty","replace","Instagram","props","state","modalVisible","key","setState","webViewState","url","title","startsWith","redirectUrl","webView","stopLoading","match","results","parse","hide","access_token","onLoginSuccess","code","split","join","appId","appSecret","responseType","onLoginFailure","headers","http","create","baseURL","form","FormData","append","post","catch","error","console","log","response","res","data","reactMessage","json","JSON","nativeEvent","error_type","err","renderClose","require","styles","imgClose","onClose","scopes","ig_uri","uri","onNavigationStateChange","bind","onMessage","wrapperStyle","containerStyle","closeStyle","container","wrapper","renderWebview","close","propTypes","string","isRequired","array","func","bool","object","defaultProps","token","Alert","alert","text","cancelable","failureJson","debug","StyleSheet","flex","backgroundColor","paddingVertical","paddingHorizontal","borderRadius","borderWidth","borderColor","position","top","right","justifyContent","alignItems"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport {\n  StyleSheet, View, Alert, Modal, Dimensions, TouchableOpacity, Image,\n} from 'react-native';\nimport qs from 'qs';\nimport axios from 'axios';\nimport { WebView } from 'react-native-webview';\nconst { width, height } = Dimensions.get('window');\n\nconst patchPostMessageJsCode = `(${String(function () {\n  var originalPostMessage = window.postMessage;\n  var patchedPostMessage = function (message, targetOrigin, transfer) {\n    originalPostMessage(message, targetOrigin, transfer);\n  };\n  patchedPostMessage.toString = function () {\n    return String(Object.hasOwnProperty).replace(\n      'hasOwnProperty',\n      'postMessage',\n    );\n  };\n  window.postMessage = patchedPostMessage;\n})})();`;\n\nexport default class Instagram extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      modalVisible: false,\n      key: 1,\n    };\n  }\n\n  show() {\n    this.setState({ modalVisible: true });\n  }\n\n  hide() {\n    this.setState({ modalVisible: false });\n  }\n\n  async onNavigationStateChange(webViewState) {\n    const { url } = webViewState;\n    const { key } = this.state;\n    if (\n      webViewState.title === 'Instagram' &&\n      webViewState.url === 'https://www.instagram.com/'\n    ) {\n      this.setState({ key: key + 1 });\n    }\n    if (url && url.startsWith(this.props.redirectUrl)) {\n      this.webView.stopLoading();\n      const match = url.match(/(#|\\?)(.*)/);\n      const results = qs.parse(match[2]);\n      this.hide();\n      if (results.access_token) {\n        // Keeping this to keep it backwards compatible, but also returning raw results to account for future changes.\n        this.props.onLoginSuccess(results.access_token, results);\n      } else if (results.code) {\n        //Fetching to get token with appId, appSecret and code\n        let { code } = results;\n        code = code.split('#_').join('');\n        const { appId, appSecret, redirectUrl, responseType } = this.props;\n        if (responseType === 'code' && !appSecret) {\n          if (code) {\n            this.props.onLoginSuccess(code, results);\n          } else {\n            this.props.onLoginFailure(results);\n          }\n        } else {\n          let headers = { 'Content-Type': 'application/x-www-form-urlencoded' };\n          let http = axios.create({\n            baseURL: 'https://api.instagram.com/oauth/access_token',\n            headers: headers,\n          });\n          let form = new FormData();\n          form.append('app_id', appId);\n          form.append('app_secret', appSecret);\n          form.append('grant_type', 'authorization_code');\n          form.append('redirect_uri', redirectUrl);\n          form.append('code', code);\n          let res = await http.post('/', form).catch((error) => {\n            console.log(error.response);\n            return false;\n          });\n\n          if (res) {\n            this.props.onLoginSuccess(res.data, results);\n          } else {\n            this.props.onLoginFailure(results);\n          }\n        }\n      } else {\n        this.props.onLoginFailure(results);\n      }\n    }\n  }\n\n  onMessage(reactMessage) {\n    try {\n      const json = JSON.parse(reactMessage.nativeEvent.data);\n      if (json && json.error_type) {\n        this.hide();\n        this.props.onLoginFailure(json);\n      }\n    } catch (err) { }\n  }\n\n  // _onLoadEnd () {\n  //   const scriptToPostBody = \"window.postMessage(document.body.innerText, '*')\"\n  //     this.webView.injectJavaScript(scriptToPostBody)\n  // }\n\n  renderClose() {\n    const { renderClose } = this.props;\n    if (renderClose) {\n      return renderClose();\n    }\n    return (\n      <Image\n        source={require('./assets/close-button.png')}\n        style={styles.imgClose}\n        resizeMode=\"contain\"\n      />\n    );\n  }\n\n  onClose() {\n    const { onClose } = this.props;\n    if (onClose) {\n      onClose();\n    }\n    // Reuse hide state update logic\n    this.hide();\n  }\n\n  renderWebview() {\n    const { appId, appSecret, redirectUrl, scopes, responseType } = this.props;\n    const { key } = this.state;\n\n    let ig_uri = `https://api.instagram.com/oauth/authorize/?app_id=${appId}&redirect_uri=${redirectUrl}&response_type=${responseType}&scope=${scopes.join(',')}`;\n\n    return (\n      <WebView\n        {...this.props}\n        key={key}\n        style={[styles.webView, this.props.styles.webView]}\n        source={{ uri: ig_uri }}\n        startInLoadingState\n        onNavigationStateChange={this.onNavigationStateChange.bind(this)}\n        onError={this.onNavigationStateChange.bind(this)}\n        onMessage={this.onMessage.bind(this)}\n        ref={(webView) => { this.webView = webView; }}\n        injectedJavaScript={patchPostMessageJsCode}\n      />\n    );\n  }\n\n  render() {\n    const { wrapperStyle, containerStyle, closeStyle } = this.props;\n\n    // Bind onClose to onRequestClose callback rather than hide to ensure that the (optional)\n    // onClose callback provided by client is called when dialog is dismissed\n    return (\n      <Modal\n        animationType={'slide'}\n        visible={this.state.modalVisible}\n        onRequestClose={this.onClose.bind(this)}\n        transparent>\n        <View style={[styles.container, containerStyle]}>\n          <View style={[styles.wrapper, wrapperStyle]}>\n            {this.renderWebview()}\n          </View>\n          <TouchableOpacity\n            onPress={() => this.onClose()}\n            style={[styles.close, closeStyle]}\n            accessibilityComponentType={'button'}\n            accessibilityTraits={['button']}>\n            {this.renderClose()}\n          </TouchableOpacity>\n        </View>\n      </Modal>\n    );\n  }\n}\nconst propTypes = {\n  appId: PropTypes.string.isRequired,\n  appSecret: PropTypes.string.isRequired,\n  redirectUrl: PropTypes.string,\n  scopes: PropTypes.array,\n  onLoginSuccess: PropTypes.func,\n  modalVisible: PropTypes.bool,\n  onLoginFailure: PropTypes.func,\n  responseType: PropTypes.string,\n  containerStyle: PropTypes.object,\n  wrapperStyle: PropTypes.object,\n  closeStyle: PropTypes.object,\n};\n\nconst defaultProps = {\n  redirectUrl: 'https://google.com',\n  styles: {},\n  scopes: ['user_profile', 'user_media'],\n  onLoginSuccess: (token) => {\n    Alert.alert('Alert Title', 'Token: ' + token, [{ text: 'OK' }], {\n      cancelable: false,\n    });\n  },\n  onLoginFailure: (failureJson) => {\n    console.debug(failureJson);\n  },\n  responseType: 'code'\n};\n\nInstagram.propTypes = propTypes;\nInstagram.defaultProps = defaultProps;\n\nconst styles = StyleSheet.create({\n  webView: {\n    flex: 1,\n  },\n  container: {\n    flex: 1,\n    backgroundColor: 'rgba(0, 0, 0, 0.5)',\n    paddingVertical: 40,\n    paddingHorizontal: 10,\n  },\n  wrapper: {\n    flex: 1,\n    borderRadius: 5,\n    borderWidth: 5,\n    borderColor: 'rgba(0, 0, 0, 0.6)',\n  },\n  close: {\n    position: 'absolute',\n    top: 35,\n    right: 5,\n    backgroundColor: '#000',\n    borderWidth: 2,\n    borderColor: 'rgba(0, 0, 0, 0.4)',\n    width: 30,\n    height: 30,\n    justifyContent: 'center',\n    alignItems: 'center',\n    borderRadius: 15,\n  },\n  imgClose: {\n    width: 30,\n    height: 30,\n  },\n});\n"]},"metadata":{},"sourceType":"module"}